<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Etikett Drucken</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        margin: 0;
        padding: 0;
        background: #dcdcdc;
        display: flex;
        flex-direction: column;
        height: 100vh;
        overflow: hidden;
        font-family: Arial, sans-serif;
    }

    /* ==== VORSCHAU-BEREICH (immer zentriert) ==== */
    .preview-wrapper {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
    }

    /* ==== A5 LANDSCAPE – feste Breite/Höhe ==== */
    .preview-area {
        width: 210mm;
        height: 148mm;
        background: white;
        padding: 8mm;
        box-sizing: border-box;
        position: relative;
        box-shadow: 0 0 12px rgba(0,0,0,0.3);
        transform-origin: center center;
    }

    .etikett {
        width: 210mm;
        height: 148mm;
        background: white;
        padding: 8mm;
        box-sizing: border-box;
        text-align: center;
        position: relative;
    }

    .textblock {
        width: 100%;
        text-align: center;
    }

    .logo-wrapper {
        position: absolute;
        right: 10mm;
        bottom: 10mm;
    }
    .logo-wrapper img {
        width: 42mm;
        height: auto;
    }

    /* ==== BOTTOM BAR ==== */
    .bottom-bar {
        display: flex;
        gap: 10px;
        padding: 10px;
        background: white;
        box-shadow: 0 -4px 8px rgba(0,0,0,0.25);
    }

    .btn {
        flex: 1;
        padding: 15px 10px;
        font-size: 22px;
        border: none;
        border-radius: 10px;
        font-weight: bold;
        color: white;
    }
    .back-btn { background:#9e9e9e; }
    .print-btn { background:#2e7d32; }

    .btn:focus {
        outline: 5px solid #1a73e8;
    }

    /* ==== DRUCK ==== */
    @media print {
        body { background:white !important; }
        .bottom-bar, .preview-wrapper { display:none !important; }

        #printArea {
            display:flex !important;
        }

        @page {
            size: A5 landscape;
            margin: 0;
        }
    }
</style>
</head>

<body>

<div class="preview-wrapper">
    <div id="scaleContainer">
        <div class="preview-area">
            <div id="previewContent" class="textblock"></div>

            <div class="logo-wrapper">
                <img src="langen.png">
            </div>
        </div>
    </div>
</div>

<!-- DRUCKVERSION -->
<div id="printArea" class="etikett" style="display:none;">
    <div id="printContent" class="textblock"></div>

    <div class="logo-wrapper">
        <img src="langen.png">
    </div>
</div>

<div class="bottom-bar">
    <button class="btn back-btn" id="backBtn">◀ Zurück</button>
    <button class="btn print-btn" id="printBtn">Drucken</button>
</div>

<script>
/* ============================================================
   DATEN LADEN
============================================================ */
window.onload = () => {

    const url = new URLSearchParams(location.search);
    let data = {};

    if (url.has("data")) {
        data = JSON.parse(decodeURIComponent(url.get("data")));
    }

    const beistell = data.beistell || "";
    const type     = data.selectedType || "";
    const kunde    = data.kundename || "";

    let html = "";

    /* ===== ZEILE 1 ===== */
    html += `<div style="font-size:60pt; font-weight:bold; margin-bottom:6mm;">${beistell}</div>`;

    /* ===== ZEILE 2/3 KUNDE ===== */
    const mapping = {
        LP:               "L&P",
        LPEILT:           "L&P|EILT",
        SCHUETTE:         "Schütte",
        SCHUETTEEILT:     "Schütte|EILT",
        KLEY:             "Kleymann",
        KLEYEILT:         "Kleymann|EILT",
        COMTEZN8:         "Comte|„Zn8“",
        COMTEZNI8:        "Comte|„ZNi8“",
        CHEMISCH:         "Comte|„Chemisch Vernickeln“",
        DICK:             "Comte|„Dickschichtpassivierung“",
        BLAU:             "Comte|„Blau ZN8“",
        PENTZ:            "Pentz & Gerdes|„ZN8“",
        RCS:              "RCS|„Schweißen“",
        COATINC:          "Coatinc 24|„Verzinken“"
    };

    if (mapping[type]) {
        const parts = mapping[type].split("|");
        html += `<div style="font-size:60pt; font-weight:bold; margin-bottom:6mm;">${parts[0]}</div>`;
        if (parts[1]) html += `<div style="font-size:32pt; font-weight:bold;">${parts[1]}</div>`;
    }

    /* ===== KUNDENNAME OPTIONAL ===== */
    if (kunde) {
        html += `<div style="font-size:32pt; margin-top:6mm;">(${kunde})</div>`;
    }

    document.getElementById("previewContent").innerHTML = html;
    document.getElementById("printContent").innerHTML   = html;

    /* ============================================================
       AUTO-SKALIERUNG FÜR HANDY & PC
    ============================================================ */
    function scalePreview() {
        const container = document.getElementById("scaleContainer");
        const area = document.querySelector(".preview-area");

        const cw = container.clientWidth;
        const ch = container.clientHeight;

        const aw = area.offsetWidth;
        const ah = area.offsetHeight;

        let scale = Math.min(cw / aw, ch / ah);
        if (scale > 1) scale = 1;

        area.style.transform = `scale(${scale})`;
    }

    scalePreview();
    window.addEventListener("resize", scalePreview);

    /* ============================================================
       BUTTONS
    ============================================================ */

    const backBtn = document.getElementById("backBtn");
    const printBtn = document.getElementById("printBtn");

    setTimeout(() => printBtn.focus(), 150);

    backBtn.onclick = () => window.location.href = "index.html";
    printBtn.onclick = () => window.print();
};
</script>

</body>
</html>